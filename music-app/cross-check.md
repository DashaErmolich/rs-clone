# Описание возможностей приложения RS Music App (максимальный балл - ``620``)

***Важные замечания***

- Для получения данных использовался [Deezer API](https://developers.deezer.com/api), являющийся REST API для стримингового сервиса [Deezer](https://www.deezer.com/), со следующими ограничениями:
  - для прослушивания доступны **30 секундные образцы** треков;
  - данные, которые получает пользователь, зависят от его региона и локали (локализация приложения не распространяется на возвращаемые API текстовые данные (например, заголовки плейлистов, названия жанров и т.д.));

- Для аутентификации пользователя используются cookie, таким образом при работе в режиме инкогнито необходимо разрешить их использование в настройках браузера.

## Общее (+ 30)

- Приложение является SPA, переход между страницами осуществляется с помощью роутинга и без перезагрузки страницы;
- Верстка приложения является отзывчивой (минимальная ширина экрана 320px);
- Приложение локализовано на два языка: русский и английский. Первоначальный язык приложения зависит от локали пользователя и может быть изменен в настройках приложения;
- Данные пользователя, указанные при регистрации, а также избранные коллекции, созданные плейлисты и т.д.,  сохраняются на сервере и доступны при повторной авторизации после выхода из аккаунта;
- Данные пользователя, касающиеся текущего состояния приложения, такие как тема, проигрываемый треклист, состояние плеера и т.д. сохраняются в local storage и очищаются при выходе из аккаунта;
- Логотип приложения в хедере ведет на главную страницу, если пользователь авторизован. В противном случае срабатыает редирект на стартовую страницу с предложением зарегистрироваться или создать аккаунт;
- Иконка и имя пользователя (десктоп) в хедере ведут на страницу с настройками приложения, если пользователь авторизован. Эта кнопка не отображается для не авторизованных пользователей;
- В футере приложения присутствуют ссылки на GitHub всех авторов приложения, год создания приложения, [логотип курса](https://rs.school/images/rs_school_js.svg) со [ссылкой на курс](https://rs.school/js/).
- Реализовано использование прокси-сервера для обработки CORS политики. CORS политика не препятствует доступу к ресурсам из разрешенных источников, определенных заранее;

## Раздел приложения для авторизациии / регистрации новых пользователей (+ 45)

### Логин и регистрация (+ 10)

- Присутствует возможность создания уникальных пользователей по адресу электронной почты и переключаться между ними.
- Каждое действие по авторизации/регистрации имеет плавное время анимации и сопровождается сообщениями пользователю;
  
### Страницы авторизации и регистрации (+ 30)

- Проверки на корректность ввода username, email, password:
  - Проверка совпадения паролей и проверка длины имени
  - Асинхронная валидация: в случае, если сервер возвращает ошибку, например уже зарегистрированный email, пользователь получит об этом уведомление в соответствующем поле;
  - При отправке формы проверяется корректность заполнения всех полей
  - Реализована дополнительная валидация формы на сервере. В случае, если невалидные данные попадут на сервер, пользователь получит сообщение с просьбой попробовать заполнить неправильное поле заново;

### Страница welcome (+ 5)

- Welcome - небольшая страница, на которую попадают пользователи, не прошедшие проверку авторизации, а также пользователи, перешедшие по ["пустому" роуту](<https://dashaermolich-rs-clone.netlify.app/>);
- Страница содержит приветствие а также ссылки на страницы авторизации и регистрации;
- В случае, если на welcome попал не прошедший авторизацию пользователь, появится сообщение с пояснением.

## Раздел приложения для поиска и прослушивания музыки (+ 390)

- Навигация по страницам приложения возможна с помощью боковой секции с ссылками на доступные страницы;
- Активная страница выделяется стилем

### Главная страница (+ 10)

- Отображение рекомендуемых для прослушивания чартов, таких как жанры, альбомы, плейлисты, исполнители, радиостанции, а также подборка из треклиста для прослушивания;

### Страница поиска (+ 65)

- Присутствует поисковая строка для отображения результатов по категориям: треки, исполнители, альбомы, плейлисты;
- Если текстовый поиск пуст, отображаются карточки по категориям, если есть данные от сервиса: жанры, плейлисты, радио;
- Данные поисковой страницы добавляется в url, а также сохраняются при перезагрузке страницы;
- Все карточки являются интерактивными и при клике ведут на соответствующий треклист по категории;
- Если в результате поиска ничего не было найдено, выводится соответствующее сообщение;
- Результаты поиска треков можно расширить, нажав соответствующую кнопку внизу треклиста;

### Треки (+ 80)

- Треки объединяются в треклисты на основании результатов поиска или готового треклиста по категории;
- Каждый трек имеет порядковый номер;
- Воспроизведение трека добавляет текущий треклист в local storage. Если в local storage уже присутствовал треклист, он перезаписывается на текущий;
- При наведении на трек появляется иконка для проигрывания трека, которая синхронизирована с состоянием плеера (состояние проиграывния трека или паузы);
- при клике на кнопку с иконкой “play” начинается воспроизведение трека, иконка кнопки меняется на “pause”, активный трек выделяется цветной границей. Также воспроизведение начинается при двойном клике по треку;
- если трек воспроизводится, при клике на кнопку с иконкой “pause”  воспроизведение останавливается, иконка меняется на “play”, цветная граница не исчезает (трек все еще является активным);
- Поведение иконок синхронизировано с иконками “play” и “pause” плеера;
- Если трек добавлен в избранное, у него присутствует соответствующая иконка;
- Если трек не добавлен в избранное, при наведении на него появляется иконка для добавления в избранное;
- Поведение иконки синхронизировано с соответствующей иконкой плеера;
- Присутствуют данные о треке:
  - название;
  - исполнитель (ссылка на соответствующую страницу);
  - альбом (при min-width 401px);
- Воспроизводимый трек будет активен в любом треклисте, независимо от того, как его найти (поиск, избранное, категория и т.д.);
- Трек, добавленный в избранное, будет иметь соответствующую иконку в любом треклисте, независимо от того, как его найти (поиск, избранное, категория и т.д.).

### Категории треклистов (исполнители, альбомы, плейлисты, радио) и жанры (+25)

- Каждая категория имеет карточку, клик по которой приводит к переходу на соответствующую страницу с треклистом;
- На странице присутствует информация о треклисте (изображение, данные);
- Воспроизведение треклиста возможно при клике на соответствующую кнопку или при клике на любой трек;
- Присутствует возможноть добавления / удаления треклиста по категории в избранное;
- Карточки с жанрами ведут на коллекцию исполнителей по данному жанру;

### Библиотека (избранное) (+ 10)

- Отображаются сохраненные пользователем треклисты по категориям;
- Отображаются избранные треки;
- Отображаются созданные пользователем плейлисты;
- Добавление треков интерактивно (в момент прослушивания можно добавить трек в избранное и состояние будет обновлено);

### Создание пользовательского плейлиста (+ 20)

- Присутствует текстовое поле для ввода имени;
- Присутствует строка поиска треков с возможностью добавления / удаления в свой треклист;
- Сохранить треклист можно при валидном имени (не более 20 символов) и как минимум одном добавленном треке нажатием на соответствующую кнопку, после чего пользователь переходит на страницу с плейлистом;

### Избранные (любимые) треки (+ 10)

- Все треки, которые пользователь отметил соответствующей иконкой на треке или в плеере, отображаются в виде треклиста;
- В случае отсутствия треков выводится соответствующее сообщение;

### Страница с  пользовательскими плейлистами (+ 10)

- Все созданные плейлисты отображаются в виде коллекции;
- В случае отсутствия плейдистов выводится соответствующее сообщение;

### Музыкальный плеер (+95)

- отображение изображение текущего трека
- отображение названия текущего трека
- отображение исполнителя текущего трека (при клике переход на страницу исполнителя)
- кнопка воспроизведения / паузы
- кнопки предыдущего / следующего трека
- кнопка для добавления текущего трека в избранное
- кнопка для перемешивания текущего треклиста
- кнопка для повтора воспроизведения текущего треклиста после окончания воспроизведения
- кнопка для повтора воспроизведения текущего трека после окончания воспроизведения
- отображение текщего прогресса воспроизведения
- кнопка для отображения эквалайзера
- кнопка для управления звуком (регулировка звука, включение/отключение беззвучного режима)
- кеопка для отображения текщего треклиста
- при уменьшении размера экрана появляется меню со скрытыми кнопками (доступны для управления плеером)

### Эквалайзер (+50)

- Для создания эквалайзера использовались возможности [Web Audio API](https://developer.mozilla.org/en-US/docs/Web/API/Web_Audio_API), анимация реализована при помощи Canvas Element;
- присутствует возможность выбора пресета с настройками эквалайзера (18 вариантов);
- присутствует возможность сброса пресета с настройками эквалайзера;
- пользователь может установить собственные настройки эквалайзера, которые будут сохранены при перезагрузке страницы;
- Присутствует визуализатор (частотная гистограмма) (frequency bar graph) проигрываемого трека;

### Текущий треклист (+15)

- Отображение текущего трека (изображение, название, исполнитель (ссылка на соответствующую страницу));
- Список треков;

## Настройки приложения (+ 50)

### Выбор языка приложения (2 варианта) (+ 5)

- Английский язык
- Русский язык
  
### Выбор темы приложения (8 вариантов) (+ 30)

- Предлагается выбор темной или светлой темы приложения
- Предлагается выбор между 4 цветовыми схемами приложения

### Настройки аккаунта пользователя (+ 15)

- Иконка пользователя:
  - Предлагается выбор из 11 иконок;
  - Активная иконка выделена цветом;
  - При выборе иконки предлагается сохранить изменения (в противном случае изменения будут не сохранены);
- Имя пользователя:
  - Текущее имя пользователя записано в текстовое поле;
  - При изменении имени предлагается сохранить изменения (в противном случае изменения будут не сохранены);
  - Текстовое поле является обязательным для заполнения;
  - Имя пользователя должно быть от 6 до 16 символов длиной;
  - Кнопка отправки формы заблокирована, в случае если валидация не успешна;

## 404 страница (+ 5)

- при попытке перехода на несуществующую страницу пользователь попадает на 404 страницу;
- присутствует SVG анимация;

## [Серверная часть приложения](<https://github.com/Sylphur/RS-MusicApp-server>) (+ 100)

- Backend-часть проекта реализована "с нуля" на node.js с испольбзованием библиотеки express-js;
- Сервер взаимодействует с базой данных MongoDB:
  - созданы схемы хранения данных: пользователей и авторизационных ключей. Определены отношения между хранимыми в БД сущностями;
  - используется ODM Mongoose;
- Приложение разбито на микросервисы и использует несколько уровней абстракции;
- Реализована JSON Web Token аутентификация:
  - реализованы два вида токенов - Access token и Refresh token. Оба вида токенов автоматически сохряются сервером в local storage (access) и в cookie (refresh);
  - Реализован Router Guard, запрашивающий валидацию Access token при переходе на защищенные страницы приложения. Дополнительно валидация происходит при загрузке приложения и при отправке наиболее чувствительных запросов (например, сохранение пользовательского плейлиста);
  - Реализована автоматическая валидация Refresh token в случае если Access token испорчен или истек срок жизни. Таким образом, приложение может сохранять информацию об авторизованном пользователе на срок до 30 дней отсутствия без необходимости повторной авторизации;
  - Обеспечены требования безопасности по хранению и передаче cookie (secure, httpOnly)
- Обеспечены требования безопасности по хранению паролей в базе данных: пароли хранятся в виде hash-значений;
- Реализована возможность подтверждения электронной почты пользователя после регистрации. Для этого реализовано взаимодействие с почтовым сервисом mail.ru через SMTP по протоколу IMAP. В результате пользователь получает автоматически сгенерированное html-письмо со ссылкой на активацию, которое не попадает в спам;
- Реализована единая система обработки и отправки HTTP-ошибок. Для обработки используется две пользовательских ошибки со статус-кодами 400 (BadRequest), 401 (Unauthorized);
- Каждый Error Response содержит body в едином формате в виде текстовых сообщений о том, что произошло. Данная информация используется в клиентской части для валидации форм и сообщений пользователю
- Сервер задеплоен на Heroku Cloud Application Platform([ссылка](https://music-app-user-server.herokuapp.com/api))
- Реализован Rest API для следующих операций:
  - Работа с аккаунтом пользователя (регистрация, аутентификация, обновление токенов);
  - Работа с внешним видом аккаунта пользователя (получение и изменение имени пользователя и иконки);
  - Работа с материалом, предоставляемым DeezerAPI (cохранение и получение избранных песен, альбомов, артистов, плейлистов и радио в формате, поддерживаемом Deezer API);
  - Сохранение и получение пользовательских плейлистов.
